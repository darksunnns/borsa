<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    
    <title>A Multiplayer Game</title>
   
    
  </head>
  <body>
    <input type="text" id="txtRoomName" placeholder="odaismi">
    <input type="text" id="mgs" placeholder="writeyourmesage" > 
    <input type="text" id="roomnumb" placeholder="roomnumb" style="width: 50px;" > 
    <button onclick="odayarat()">Oda yarat</button>
    <button onclick="tikla()">Odaya Giriş Yap</button>
    <button onclick="kartsec()">kartsec</button>
    <div id="money" style="color:red">300$</div>
    <div id="bmw">bmw 100</div>
    <div id="ibm">ibm 100</div>
    <div id="shell">shell 100</div>
    <div id="ebay">ebay 100</div>


  
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      let socket=io.connect();
      var playkey=false;
      var promtkey=true;
      var limitkey=false;
      var name ;
      var msg;
      var  roomnumb;
      if(limitkey){
        var odalimit =  prompt("oda kaç kişilik olsun ?");
        if(odalimit.length>=0){limitkey=false;};
      };
                
      function odayarat()  {
                   roomnumb =document.getElementById("roomnumb").value;
                   var thisGameId = ( Math.random() * 100000 ) | 0;
                      var muz= thisGameId.toString();
                      muz =muz+roomnumb.toString();
                   name =document.getElementById("txtRoomName").value=muz;
                 
                
                   alert(name[name.length-1]);
                 //   msg =document.getElementById("mgs").value;
                  //   var param =socket.id;
                 
                    alert(name);
                 //   socket.emit("login", {"isim":name,"yazi":msg,"param":"kaan","odalimit":odalimit});
               };

               function tikla()  {
                   name =document.getElementById("txtRoomName").value;
                    msg =document.getElementById("mgs").value;
                    roomnumb =document.getElementById("roomnumb").value=name[name.length-1];
                     var param =socket.id;
                 //    if( odalimit == null){
                  //     odalimit=name[name.length-1];
                  //     alert(odalimit);
                 //    };
                     alert(name);
                   // alert(odalimit);
                    socket.emit("login", {"isim":name,"yazi":msg,"param":"kaan","odalimit":roomnumb});
               };
                
            
               function kartsec(){
           
         if(playkey){
          if(promtkey){
            var deger =  prompt("degergir");
            var sabitdeger =deger;
             alert("olmus");
             console.log(deger.length);
             if(deger.length>=0){promtkey=false;};
           
           };
       socket.emit("gamedata", {"kart":true,"deger":sabitdeger});
       //socket.emit("login", {"isim":name,"yazi":msg,"param":"kaan"});
       
          };
       
        };
             



              // socket.on("message", data => $("#message").append(`<li>${data} odasına bağlanıldı.</li>`));
               socket.on("message", function (data) {
               
           playkey=data.playkey;
      
              
           
       //      `<li>${data} odasına bağlanıldı.</li>`

           var bolum = document.createElement("p");
           var icerik = document.createTextNode("id :"+"  "+socket.id + " :"+data.isim)
           bolum.appendChild(icerik);
  
           document.body.appendChild(bolum);

        
              
          
           

          // socket.emit("login", {"isim":name,"yazi":msg,"param":"kaan"});


               });



               socket.on("newevent", function (veri) {
            console.log(veri);
          console.log(socket.id);

              // alert(data);
               var bolumm = document.createElement("p");
           var icerikk = document.createTextNode("verim :"+"  "+ veri.servermes )
           bolumm.appendChild(icerikk);
  
           document.body.appendChild(bolumm);
        
     //   alert("bu fonksiyon çalışıyo");
     //   alert("newid"+" "+clientid+"and"+"stabil id :"+veri.stabilid);
       //  if(data.id == veri.stabilid){
         //  alert("newid"+" "+clientid+"and"+"stabil id :"+veri.stabilid);
        //  alert("yourturn");
   
     //    };
   
         });
      
      
         socket.on("ozel", function (islem) {
           alert("özelmesaj geldi");
          socket.emit("serverclick", {"on":true});
          if(islem.tikla){   
             tikla();  
              } ;
    
         });
         
         socket.on("updategamedata", function (data) {
           
          document.getElementById("money").innerHTML=300;

         console.log(data.sirket);
         for (var i = 0; i < data.sirket.length; i++) {
           console.log(data.sirket.length);
          document.getElementById(data.sirket[i]).innerHTML=data.sirket[i]+data.deger[i];    
             
          };
         
         });


     
         

         
          
         



    </script>
  
   
  </body>
</html>